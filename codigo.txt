// publicacion.h
#include <iostream>
using namespace std;

class publicacion
{
    
private:
    string titulo;
    int anioEdicion;
    float PrecioBase; 

public:
    publicacion(const string& _titulo, int _anioEdicion, float _precioBase): 
    titulo(_titulo), 
    anioEdicion(_anioEdicion), 
    PrecioBase(_precioBase) {}

    virtual ~publicacion();

    virtual void listarInformacion() const {
        cout << "Título: " << titulo << endl;
        cout << "Año de Edición: " << anioEdicion << endl;
        cout << "Precio Base: " << PrecioBase << endl;
    }
    virtual float calcularPrecio(){
        return PrecioBase; //corregir
    }

    // get
    float getPrecioBase(){
        return PrecioBase;
    }

    int getAnioEdicion(){
        return anioEdicion;
    }
    

};

// libro.h
#include <iostream>
#include "publicacion.h"
using namespace std;

class libro : public publicacion
{
private:
    int ISBN; //? 
    string autorPrincipal;
    bool bestSeller;
    
public:
    libro(const string& _titulo, int _anioEdicion, float _precioBase, int _ISBN, const string& _autorPrincipal, bool _bestSeller): 
    publicacion(_titulo, _anioEdicion, _precioBase), 
    ISBN(_ISBN), 
    autorPrincipal(_autorPrincipal), bestSeller(_bestSeller) {}

    ~libro(){
        // 
    }

    // void listarInformacion(){
    //     // 
    // }

    bool esBestSeller(){
        return bestSeller;
    }

    float calcularPrecio(){
        float costo = getPrecioBase();
        if (bestSeller)
        {
            costo = costo*1.1;
            
        }
        costo = costo*1.21;
        return costo;
    }
    
};

// revista.h
#include <iostream>
#include "publicacion.h"
using namespace std;

class revista : public publicacion
{
private:
    int ISSN; //?
    int numero;
    int volumen;
    string campoTematico;

public:
    revista(const string& _titulo, int _anioEdicion, float _precioBase, int _ISSN, int _numero, int _volumen, const string& _campoTematico): 
    publicacion(_titulo, _anioEdicion, _precioBase), 
    ISSN(_ISSN), 
    numero(_numero), 
    volumen(_volumen), 
    campoTematico(_campoTematico) {}

    ~revista(){
        // 
    }

    float calcularPrecio(){
        float costo = getPrecioBase();
        if (getAnioEdicion()>5)
        {
            return costo;
        }else
        {
            costo = costo*0.85;
        }
        costo = costo*1.21;
        return costo;
    }
};

// venta.h
#include <iostream>
#include "publicacion.h"
using namespace std;

// relacion de agregacion entre venta y publicacion
class venta
{
private:
    int codigoVenta;
    string fechaVenta;
    publicacion** articulosVenidos;
    // add
    int numArticulos;    
public:
    venta(int _codigoVenta, const string& _fechaVenta): codigoVenta(_codigoVenta), 
    fechaVenta(_fechaVenta){}
    
    ~venta() {
        for (int i = 0; i < numArticulos; i++) {
            delete articulosVenidos[i];
        }
        delete[] articulosVenidos;
    }

    void agregarArticulo(publicacion* articulo) {
        // 
        publicacion** temp = new publicacion*[numArticulos + 1];
        for (int i = 0; i < numArticulos; i++) {
            temp[i] = articulosVenidos[i];
        }
        temp[numArticulos] = articulo;
        delete[] articulosVenidos;
        articulosVenidos = temp;
        numArticulos++;
    }
    

    void listarInformacion() const {
        cout << "Código de Venta: " << codigoVenta << endl;
        cout << "Fecha de Venta: " << fechaVenta << endl;
        cout << "Artículos vendidos:" << endl;
        for (int i = 0; i < numArticulos; i++) {
            articulosVenidos[i]->listarInformacion();
            cout << "Precio de venta: " << articulosVenidos[i]->calcularPrecio() << endl;
        }
    }

    float calcularMontoVenta() const {
        float montoTotal = 0.0;
        for (int i = 0; i < numArticulos; i++) {
            montoTotal += articulosVenidos[i]->calcularPrecio();
        }
        return montoTotal;
    }

    // add
    string getFechaVenta(){
        return fechaVenta;
    }
};


// sistema.h
#include <iostream>
#include "venta.h"
using namespace std;

// relacion de composicion entre venta y sistema
class sistema
{
private:
    // add
    venta** ventasRealizadas;
    int numVentas;

public:
    sistema(): 
    ventasRealizadas(NULL), 
    numVentas(0) {}

    ~sistema() {
        for (int i = 0; i < numVentas; i++) {
            delete ventasRealizadas[i];
        }
        delete[] ventasRealizadas;
    }   

    // add
    void registrarVenta(venta* nuevaVenta) {
        // 
        venta** temp = new venta*[numVentas + 1];
        for (int i = 0; i < numVentas; i++) {
            temp[i] = ventasRealizadas[i];
        }
        temp[numVentas] = nuevaVenta;
        delete[] ventasRealizadas;
        ventasRealizadas = temp;
        numVentas++;
    }

    // add
    void listarVentasEnFecha(const string& fecha) const {
        cout << "Ventas realizadas en la fecha " << fecha << ":" << endl;
        for (int i = 0; i < numVentas; i++) {
            if (ventasRealizadas[i]->getFechaVenta() == fecha) {
                ventasRealizadas[i]->listarInformacion();
                cout << "Monto de la venta: " << ventasRealizadas[i]->calcularMontoVenta() << endl;
            }
        }
    }

    float calcularMontoTotalEnMes(int mes){
        float montoTotal = 0.0;
        for (int i = 0; i < numVentas; i++) {
            int ventaMes = stoi(ventasRealizadas[i]->getFechaVenta().substr(5, 2));
            if (ventaMes == mes) {
                montoTotal += ventasRealizadas[i]->calcularMontoVenta();
            }
        }
        return montoTotal;
    }

};




